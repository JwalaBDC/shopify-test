export class HorizontalScrollbar{constructor(t){this.thumb=t,this.container=this.thumb.closest(".js-horizontalScrollbar__container"),this.scroller=this.container.querySelector(".js-horizontalScrollbar__scroller"),this.track=this.container.querySelector(".js-horizontalScrollbar__track"),this.resizeTimer=!1,this.thumbX={last:0,current:0,eased:0},this.isDragging=!1,this.isMouseDown=!1,this.addEventListeners(),this.setDimensions(),requestAnimationFrame(this.tick.bind(this))}lerp(t,s,i=.12){return(1-i)*t+i*s}mapRange(t,s,i,r,e){return((t=this.setBounds(t,s,i))-s)*(e-r)/(i-s)+r}setBounds(t,s,i){return Math.min(Math.max(t,s),i)}get thumbWidth(){const t=100*this.offsetWidth/this.scrollWidth;return t<100?t*this.trackWidth/100:0}setDimensions(){this.trackWidth=this.track.offsetWidth,this.scrollWidth=this.scroller.scrollWidth,this.offsetWidth=this.scroller.offsetWidth,this.thumb.style.width=this.thumbWidth+"px",this.minX=0,this.maxX=this.trackWidth-this.thumbWidth,this.track.classList.toggle("isHidden",this.scrollWidth-this.offsetWidth<=0),this.container.classList.toggle("isOverflowing",!(this.scrollWidth-this.offsetWidth<=0))}tick(){this.thumbX.eased=this.lerp(this.thumbX.eased,this.thumbX.current,.4),this.thumb.style.transform=`translate3d(${this.thumbX.eased}px, 0, 0)`,requestAnimationFrame(this.tick.bind(this))}startDragMouse(t){this.isMouseDown=!0,this.scroller.classList.add("--grab"),this.scrollStartX=t.pageX||t.touches[0].pageX-this.scroller.offsetLeft,this.scrollLeft=this.scroller.scrollLeft}stopDragMouse(){this.isMouseDown=!1,this.scroller.classList.remove("--grab")}dragMouse(t){if(!this.isMouseDown)return;const s=(t.pageX||t.touches[0].pageX-this.scroller.offsetLeft)-this.scrollStartX;this.scroller.scrollLeft=this.scrollLeft-s}startDrag(t){this.isDragging=!0,this.startX=t.pageX,this.scrollStartX=this.scroller.scrollLeft}stopDrag(){this.isDragging=!1}drag(t){if(!this.isDragging)return;const s=(t.pageX-this.startX)*(this.scrollWidth/this.trackWidth);this.scroller.scrollLeft=this.scrollStartX+s}addEventListeners(){this.scroller.addEventListener("scroll",()=>{0===this.scroller.scrollLeft?this.thumbX.current=0:this.thumbX.current=this.mapRange(this.scroller.scrollLeft,0,this.scrollWidth-this.offsetWidth,this.minX,this.maxX)}),window.addEventListener("resize",()=>{clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(()=>{this.setDimensions()},100)}),this.thumb.addEventListener("mousedown",this.startDrag.bind(this)),window.addEventListener("mouseup",this.stopDrag.bind(this)),window.addEventListener("mousemove",this.drag.bind(this)),this.scroller.addEventListener("mousedown",this.startDragMouse.bind(this)),this.scroller.addEventListener("mousemove",this.dragMouse.bind(this)),this.scroller.addEventListener("mouseleave",this.stopDragMouse.bind(this)),this.scroller.addEventListener("mouseup",this.stopDragMouse.bind(this))}}const horizontalScrollThumbs=document.querySelectorAll(".js-horizontalScrollbar__thumb");if(horizontalScrollThumbs.length>0){const t=new ResizeObserver(t=>{t.forEach(t=>{let s=t.target.closest(".js-horizontalScrollbar__container").querySelector(".js-horizontalScrollbar__thumb");s&&s.horizontalScrollbarInstance&&s.horizontalScrollbarInstance.setDimensions()})});horizontalScrollThumbs.forEach(s=>{s.horizontalScrollbarInstance=new HorizontalScrollbar(s);let i=s.closest(".js-horizontalScrollbar__container"),r=i.querySelector(".js-horizontalScrollbar__scroller");t.observe(r),r.dataset.overflowing=r.scrollWidth>i.offsetWidth?"true":"false";const e=i.closest("[role=tabpanel]");if(e&&e.hasAttribute("tabindex")){new MutationObserver(t=>{t.forEach(t=>{"hidden"!==t.attributeName||e.hasAttribute("hidden")||s.horizontalScrollbarInstance.setDimensions()})}).observe(e,{attributes:!0})}})}