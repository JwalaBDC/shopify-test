class AccordionInterface extends HTMLElement{constructor(){super(),this.triggers=this.querySelectorAll("[accordion-button]"),this.clickHandler=this.createClickHandler(),this.keyHandler=this.createKeyHandler(),this.init()}init(){for(const t of this.triggers){const e=t.closest("[accordion]");let i=e?.querySelector("[accordion-content]");e.classList.contains("is-accordion-expanded")?(gsap.set(i,{height:"auto"}),t.setAttribute("aria-expanded","true"),i.setAttribute("display-content","true"),window.innerWidth>768&&i.closest("footer")&&i.setAttribute("tabindex","0"),this.enableElementFocusability(i)):(gsap.set(i,{height:0,overflow:"hidden"}),t.setAttribute("aria-expanded","false"),i.setAttribute("display-content","false"),i.setAttribute("tabindex","-1"),this.disableElementFocusability(i))}}createClickHandler(){return t=>{const e=t.currentTarget,i=e.closest("[accordion]");let s=i.querySelector("[accordion-content]"),r="true"===e.getAttribute("aria-expanded");e.setAttribute("aria-expanded",!r),s.setAttribute("display-content",!r),window.innerWidth>768&&s.closest("footer")&&s.setAttribute("tabindex",r?"0":"-1"),r?this.disableElementFocusability(s):this.enableElementFocusability(s);const n=s.classList.contains("instant-transition"),o=i.hasAttribute("scroll-into-view-on-click"),a=i.hasAttribute("close-instantly-on-click");r?(i.classList.remove("is-accordion-expanded"),a?gsap.set(s,{height:0}):gsap.to(s,{height:0,duration:n?0:.1,ease:"standard"})):(i.classList.add("is-accordion-expanded"),gsap.to(s,{height:"auto",duration:n?0:.2,ease:"standard-decelerate",onComplete:()=>{o&&i.scrollIntoView({behavior:"smooth",block:"start"})}}))}}disableElementFocusability(t){if(!t||window.innerWidth>768&&t.closest("footer"))return;t.querySelectorAll("input, button, a, select, textarea").forEach(t=>{t.setAttribute("tabindex","-1")})}enableElementFocusability(t){if(!t||window.innerWidth>768&&t.closest("footer"))return;t.querySelectorAll("input, button, a, select, textarea").forEach(t=>{t.removeAttribute("tabindex")})}createKeyHandler(){return t=>{const e=Array.from(this.triggers).indexOf(t.target);"Enter"===t.key||" "===t.key?(t.preventDefault(),this.clickHandler(t)):"ArrowUp"===t.key||"ArrowLeft"===t.key?this.focusPreviousButton(e,t):"ArrowDown"===t.key||"ArrowRight"===t.key?this.focusNextButton(e,t):"Home"===t.key?this.focusFirstButton(t):"End"===t.key&&this.focusLastButton(t)}}focusPreviousButton(t,e){this.triggers[t-1]&&(this.triggers[t-1].focus(),e.preventDefault())}focusNextButton(t,e){this.triggers[t+1]&&(this.triggers[t+1].focus(),e.preventDefault())}focusFirstButton(t){this.triggers[0]?.focus(),t.preventDefault()}focusLastButton(t){this.triggers[this.triggers.length-1]?.focus(),t.preventDefault()}addMutationObserver(){this.mutationObserver=new MutationObserver(t=>{for(const e of t)console.log(e),"childList"===e.type&&this.setupTriggers()})}setupTriggers(){this.triggers=this.querySelectorAll("[accordion-button]");for(const t of this.triggers)t.addEventListener("click",this.clickHandler),t.addEventListener("keydown",this.keyHandler)}connectedCallback(){this.addMutationObserver(),this.mutationObserver.observe(this,{childList:!0,subtree:!0}),this.setupTriggers()}disconnectedCallback(){this.mutationObserver.disconnect();for(const t of this.triggers)t.removeEventListener("click",this.clickHandler),t.removeEventListener("keydown",this.keyHandler)}}customElements.define("accordion-interface",AccordionInterface);