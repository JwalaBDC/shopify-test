class ImageCarouselInterface extends HTMLElement{constructor(){super(),this.container=this.querySelector(".ui-image-carousel"),this.cardLists=[...this.querySelectorAll("[slider-card-list]")],this.cards=[...this.querySelectorAll("[slider-card]")],this.sliderNavs=[...this.querySelectorAll("[slider-nav]")],this.prevBtns=[...this.querySelectorAll("[slider-prev]")],this.nextBtns=[...this.querySelectorAll("[slider-next]")],this.sliderDots=[...this.querySelectorAll("[slider-dots]")],this.playBtns=[...this.querySelectorAll(".ui-image-carousel__play-btn")],this.pauseBtns=[...this.querySelectorAll(".ui-image-carousel__pause-btn")],this.prevClickHandler=this.createPrevClickHandler(),this.nextClickHandler=this.createNextClickHandler(),this.playClickHandler=this.createPlayClickHandler(),this.pauseClickHandler=this.createPauseClickHandler(),this.scrollHandler=this.createScrollHandler()}setupComponentObserver(){this.componentObserver=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting?this.continueAutoplay():this.pauseAutoplay()})},{root:null,threshold:.5})}setupCardObserver(){this.observer=new IntersectionObserver(e=>{e.forEach(e=>{const t=e.target,s=t.hasAttribute("slider-card"),i=t.hasAttribute("slider-card-list"),r=e.isIntersecting;s&&(t.setAttribute("aria-hidden",r?"false":"true"),this.setSliderBtnState()),i&&(t.classList.toggle("is-visible",r),this.setSliderNavVisibility())})},{root:document.documentElement,threshold:.99})}observeElements(e){for(const t of e)this.observer.observe(t)}unobserveElements(e){for(const t of e)this.observer.unobserve(t)}setSliderBtnState(){let e=this.cardLists.some(e=>{const t=e.querySelector("[slider-card]");return t&&"false"===t.getAttribute("aria-hidden")});for(const t of this.prevBtns)t.disabled=e;let t=this.cardLists.some(e=>{const t=e.querySelectorAll("[slider-card]"),s=t[t.length-1];return s&&"false"===s.getAttribute("aria-hidden")});for(const e of this.nextBtns)e.disabled=t}setSliderNavVisibility(){const e=Array.from(this.cardLists).filter(e=>e.classList.contains("is-visible")),t=0===e.length||e.some(e=>{const t=e.querySelectorAll("[slider-card]");return Array.from(t).every(e=>"false"===e.getAttribute("aria-hidden"))});for(const e of this.sliderNavs)e.hidden=t}createScrollHandler(){return e=>{const t=e.currentTarget;t.disableSliderBtnClicks=!0,clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout(()=>{t.disableSliderBtnClicks=!1},100)}}getCardsPerSlide(e){let t=1;return window.innerWidth>767&&(t=e.hasAttribute("data-cards-per-slide")?parseInt(e.dataset.cardsPerSlide):1),t}createNextClickHandler(){return()=>{const e=this.cardLists.find(e=>e.classList.contains("is-visible"));if(!e)return;const t=[...e.querySelectorAll("[slider-card]")];let s=t.findIndex(e=>"false"===e.getAttribute("aria-hidden")),i=t[s],r=t[s+1];t[t.length-1];if(!e.disableSliderBtnClicks&&!this.classList.contains("is-slider-animating"))if(this.pauseAutoplay(),r){this.setActiveSliderDot(e,s+1);this.getCardsPerSlide(e);const t=r.getBoundingClientRect().width*(s+1);e.classList.add("disable-scroll-snapping"),this.classList.add("is-slider-animating");const l=gsap.timeline({onComplete:()=>{gsap.set([i,r],{clearProps:"all",onComplete:()=>{e.scrollTo({left:t,behavior:"instant"}),this.continueAutoplay()}}),e.classList.remove("disable-scroll-snapping"),this.classList.remove("is-slider-animating")}});l.fromTo(i,{xPercent:0},{xPercent:-30,duration:.4,ease:"emphasized-accelerate"},0),l.fromTo(r,{xPercent:0},{xPercent:-100,duration:.4,ease:"emphasized"},0)}else{s=-1;let i=t[t.length-1];r=t[0],this.setActiveSliderDot(e,s+1);const l=r.getBoundingClientRect().width*(s+1);e.classList.add("disable-scroll-snapping"),this.classList.add("is-slider-animating");const n=gsap.timeline({onComplete:()=>{gsap.set([i,r],{clearProps:"all",onComplete:()=>{e.scrollTo({left:l,behavior:"instant"}),this.continueAutoplay()}}),e.classList.remove("disable-scroll-snapping"),this.classList.remove("is-slider-animating")}});n.set(i,{zIndex:0}),n.set(r,{xPercent:100*(t.length-1),zIndex:1}),n.fromTo(i,{xPercent:0},{xPercent:-30,duration:.4,ease:"emphasized-accelerate"},0),n.fromTo(r,{xPercent:100*t.length},{xPercent:100*(t.length-1),duration:.4,ease:"emphasized"},0)}}}createPrevClickHandler(){return()=>{const e=this.cardLists.find(e=>e.classList.contains("is-visible"));if(!e)return;const t=[...e.querySelectorAll("[slider-card]")],s=t.findIndex(e=>"false"===e.getAttribute("aria-hidden")),i=t[s],r=t[s-1];if(!e.disableSliderBtnClicks&&!this.classList.contains("is-slider-animating")&&(this.pauseAutoplay(),r)){this.setActiveSliderDot(e,s-1);const t=this.getCardsPerSlide(e),l=r.getBoundingClientRect().width*(s-t);e.classList.add("disable-scroll-snapping"),this.classList.add("is-slider-animating");const n=gsap.timeline({onComplete:()=>{e.scrollTo({left:l,behavior:"instant"}),gsap.set([i,r],{clearProps:"all"}),e.classList.remove("disable-scroll-snapping"),this.continueAutoplay(),this.classList.remove("is-slider-animating")}});n.fromTo(i,{xPercent:0},{xPercent:30,duration:.4,ease:"emphasized-accelerate"},0),n.fromTo(r,{xPercent:0},{xPercent:100,zIndex:1,duration:.4,ease:"emphasized"},0)}}}scrollToCardList(e){let t;const s=e.getBoundingClientRect(),i=window.innerHeight;s.bottom>i&&(t=s.bottom-i),window.scrollBy({top:t,behavior:"smooth"})}setActiveSliderDot(e,t){e.querySelector("[slider-dots]").querySelectorAll("span").forEach((e,s)=>{e.classList.remove("is-active"),s===t&&e.classList.add("is-active")})}createPlayClickHandler(){return e=>{this.isAutoplayPaused=!1,clearInterval(this.nextClickInterval),this.nextClickInterval=setInterval(this.nextClickHandler,4e3);for(const e of this.playBtns)e.hidden=!0;for(const e of this.pauseBtns)e.removeAttribute("hidden")}}createPauseClickHandler(){return e=>{this.isAutoplayPaused=!0,clearInterval(this.nextClickInterval);for(const e of this.playBtns)e.removeAttribute("hidden");for(const e of this.pauseBtns)e.hidden=!0}}pauseAutoplay(){clearInterval(this.nextClickInterval)}continueAutoplay(){this.isAutoplayPaused||(clearInterval(this.nextClickInterval),this.nextClickInterval=setInterval(this.nextClickHandler,4e3))}connectedCallback(){this.setupCardObserver(),this.setupComponentObserver(),this.componentObserver.observe(this),this.observeElements(this.cards),this.observeElements(this.cardLists);for(const e of this.cardLists)e.addEventListener("scroll",this.scrollHandler);for(const e of this.nextBtns)e.addEventListener("click",this.nextClickHandler);for(const e of this.prevBtns)e.addEventListener("click",this.prevClickHandler);for(const e of this.playBtns)e.addEventListener("click",this.playClickHandler);for(const e of this.pauseBtns)e.addEventListener("click",this.pauseClickHandler)}disconnectedCallback(){this.componentObserver.unobserve(this),this.unobserveElements(this.cards),this.unobserveElements(this.cardLists);for(const e of this.cardLists)e.removeEventListener("scroll",this.scrollHandler);for(const e of this.nextBtns)e.removeEventListener("click",this.nextClickHandler);for(const e of this.prevBtns)e.removeEventListener("click",this.prevClickHandler);for(const e of this.playBtns)e.removeEventListener("click",this.playClickHandler);for(const e of this.pauseBtns)e.removeEventListener("click",this.pauseClickHandler);clearInterval(this.nextClickInterval)}}customElements.define("image-carousel-interface",ImageCarouselInterface);