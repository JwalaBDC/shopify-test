class SliderInterface extends HTMLElement{constructor(){super(),this.cardLists=[...this.querySelectorAll("[slider-card-list]")],this.cards=[...this.querySelectorAll("[slider-card]")],this.sliderNavs=[...this.querySelectorAll("[slider-nav]")],this.prevBtns=[...this.querySelectorAll("[slider-prev]")],this.nextBtns=[...this.querySelectorAll("[slider-next]")],this.header=document.querySelector("header"),this.headerheight=parseInt(this.header&&this.header.offsetHeight||0),this.prevClickHandler=this.createPrevClickHandler(),this.nextClickHandler=this.createNextClickHandler(),this.scrollHandler=this.createScrollHandler(),this.sliderScrollIndicatorTracks=[...this.querySelectorAll("[slider-scroll-indicator-track]")],this.sliderScrollIndicatorThumbs=[...this.querySelectorAll("[slider-scroll-indicator-thumb]")],this.tables=[...this.querySelectorAll("table[slider-card]")],this.setupTableSlider()}setupTableSlider(){const e=document.querySelector("slider-interface[slider-table]");if(!e)return;const t=e.querySelector("[slider-card-list]"),s=e.querySelector("[slider-prev]"),r=e.querySelector("[slider-next]"),i=e.querySelector("[slider-nav]");if(setTimeout(()=>{i&&i.removeAttribute("hidden")},100),!t||!s||!r)return void console.warn("Required slider elements not found!");const l=1*t.clientWidth,o=()=>{const e=t.scrollWidth-t.clientWidth,i=Math.round(t.scrollLeft);s.disabled=i<=0,r.disabled=i>=e},n=e=>{const s=t.scrollWidth-t.clientWidth;let r="prev"===e?t.scrollLeft-l:t.scrollLeft+l;r=Math.max(0,Math.min(r,s)),t.scrollTo({left:r,behavior:"smooth"}),setTimeout(o,300)};s.addEventListener("click",()=>n("prev")),r.addEventListener("click",()=>n("next")),t.addEventListener("scroll",o),o()}setScrollIndicatorThumbDimensions(){this.sliderScrollIndicatorThumbs.forEach((e,t)=>{const s=this.sliderScrollIndicatorTracks[t],r=s.offsetWidth,i=this.cardLists[t].scrollWidth,l=this.cardLists[t].offsetWidth,o=100*l/i,n=o<100?o*r/100:0;this.scrollMapRangeObjects||(this.scrollMapRangeObjects=[],this.scrollMapRangeObjects.push({inMin:0,inMax:0,outMin:0,outMax:0})),this.scrollMapRangeObjects[t]={inMin:0,inMax:i-l,outMin:0,outMax:r-n},e.style.width=`${n}px`,i<=l?s.parentElement.parentElement.style.display="none":(s.parentElement.parentElement.style.display="flex",requestAnimationFrame(()=>{this.setScrollIndicatorThumbDimensions()}))})}updateScrollIndicatorThumbPositions(){this.sliderScrollIndicatorThumbs.forEach((e,t)=>{const{inMin:s,inMax:r,outMin:i,outMax:l}=this.scrollMapRangeObjects[t],o=this.cardLists[t].scrollLeft;let n=0;0===o?n=0:(n=gsap.utils.mapRange(s,r,i,l,o),n=gsap.utils.clamp(i,l,n)),e.style.transform=`translate3d(${n}px, 0, 0)`})}reinitialize(){this.unobserveElements(this.cards),this.unobserveElements(this.cardLists),this.cardLists=[...this.querySelectorAll("[slider-card-list]")],this.cards=[...this.querySelectorAll("[slider-card]")],this.observeElements(this.cards),this.observeElements(this.cardLists)}setupCardObserver(){this.cardObserver=new IntersectionObserver(e=>{e.forEach(e=>{const t=e.target,s=t.hasAttribute("slider-card"),r=e.isIntersecting;s&&(t.setAttribute("aria-hidden",r?"false":"true"),r?t.removeAttribute("tabindex"):t.setAttribute("tabindex","-1"),this.setSliderBtnState())})},{root:document.documentElement,threshold:.99})}setupCardListObserver(){this.cardListObserver=new IntersectionObserver(e=>{e.forEach(e=>{const t=e.target,s=t.hasAttribute("slider-card-list"),r=e.isIntersecting;s&&(t.classList.toggle("is-visible",r),this.setSliderNavVisibility(),this.setScrollIndicatorThumbDimensions())})},{root:document.documentElement,threshold:.1})}observeCards(e){for(const t of e)this.cardObserver.observe(t)}unobserveCards(e){for(const t of e)this.cardObserver.unobserve(t)}observeCardLists(e){for(const t of e)this.cardListObserver.observe(t)}unobserveCardLists(e){for(const t of e)this.cardListObserver.unobserve(t)}setSliderBtnState(){let e=this.cardLists.some(e=>{const t=e.querySelector("[slider-card]");return t&&"false"===t.getAttribute("aria-hidden")});for(const t of this.prevBtns)t.disabled=e;let t=this.cardLists.some(e=>{const t=e.querySelectorAll("[slider-card]"),s=t[t.length-1];return s&&"false"===s.getAttribute("aria-hidden")});for(const e of this.nextBtns)e.disabled=t}setSliderNavVisibility(){setTimeout(()=>{const e=Array.from(this.cardLists).filter(e=>e.classList.contains("is-visible")),t=0===e.length||e.some(e=>{const t=e.querySelectorAll("[slider-card]");return Array.from(t).every(e=>"false"===e.getAttribute("aria-hidden"))});for(const e of this.sliderNavs)e.hidden=t},100)}createScrollHandler(){return e=>{this.updateScrollIndicatorThumbPositions();const t=e.currentTarget;t.disableSliderBtnClicks=!0;for(const e of this.nextBtns)e.classList.add("is-pressed-state-blocked");for(const e of this.prevBtns)e.classList.add("is-pressed-state-blocked");clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout(()=>{t.disableSliderBtnClicks=!1;for(const e of this.nextBtns)e.classList.remove("is-pressed-state-blocked");for(const e of this.prevBtns)e.classList.remove("is-pressed-state-blocked")},100)}}getCardsPerSlide(e){let t=1;return window.innerWidth>767&&(t=e.hasAttribute("data-cards-per-slide")?parseInt(e.dataset.cardsPerSlide):2),t}createNextClickHandler(){return()=>{const e=this.cardLists.find(e=>e.classList.contains("is-visible"));if(!e)return;const t=[...e.querySelectorAll("[slider-card]")],s=t.findIndex(e=>"false"===e.getAttribute("aria-hidden")),r=t[s+1];if(!e.disableSliderBtnClicks&&r){const t=this.getCardsPerSlide(e);this.scrollToCardList(e),e.scrollTo({left:r.getBoundingClientRect().width*(s+t),behavior:"smooth"})}}}createPrevClickHandler(){return()=>{const e=this.cardLists.find(e=>e.classList.contains("is-visible"));if(!e)return;const t=[...e.querySelectorAll("[slider-card]")],s=t.findIndex(e=>"false"===e.getAttribute("aria-hidden")),r=t[s-1];if(!e.disableSliderBtnClicks&&r){const t=this.getCardsPerSlide(e);this.scrollToCardList(e),e.scrollTo({left:r.getBoundingClientRect().width*(s-t),behavior:"smooth"})}}}scrollToCardList(e){let t;const s=this.getBoundingClientRect(),r=window.innerHeight,i=s.bottom-r,l=s.top-i;s.bottom>r&&l>this.headerheight&&(t=s.bottom-r),window.scrollBy({top:t,behavior:"smooth"})}connectedCallback(){this.setupCardObserver(),this.setupCardListObserver(),this.setScrollIndicatorThumbDimensions(),this.observeCards(this.cards),this.observeCardLists(this.cardLists);for(const e of this.cardLists)e.addEventListener("scroll",this.scrollHandler);for(const e of this.nextBtns)e.addEventListener("click",this.nextClickHandler);for(const e of this.prevBtns)e.addEventListener("click",this.prevClickHandler)}disconnectedCallback(){this.unobserveCards(this.cards),this.unobserveCardLists(this.cardLists);for(const e of this.cardLists)e.removeEventListener("scroll",this.scrollHandler);for(const e of this.nextBtns)e.removeEventListener("click",this.nextClickHandler);for(const e of this.prevBtns)e.removeEventListener("click",this.prevClickHandler)}}customElements.define("slider-interface",SliderInterface);