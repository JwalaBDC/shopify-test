class ProductSliderInterface extends HTMLElement{constructor(){super(),this.cardLists=[...this.querySelectorAll("[slider-card-list]")],this.cards=[...this.querySelectorAll("[slider-card]")],this.sliderNavs=[...this.querySelectorAll("[slider-nav]")],this.prevBtns=[...this.querySelectorAll("[slider-prev]")],this.nextBtns=[...this.querySelectorAll("[slider-next]")],this.prevClickHandler=this.createPrevClickHandler(),this.nextClickHandler=this.createNextClickHandler(),this.scrollHandler=this.createScrollHandler()}setupCardObserver(){this.observer=new IntersectionObserver(e=>{e.forEach(e=>{const t=e.target,s=t.hasAttribute("slider-card"),r=t.hasAttribute("slider-card-list"),i=e.isIntersecting;s&&(t.setAttribute("aria-hidden",i?"false":"true"),this.setSliderBtnState()),r&&(t.classList.toggle("is-visible",i),this.setSliderNavVisibility())})},{root:document.documentElement,threshold:.99})}observeElements(e){for(const t of e)this.observer.observe(t)}unobserveElements(e){for(const t of e)this.observer.unobserve(t)}setSliderBtnState(){let e=this.cardLists.some(e=>{const t=e.querySelector("[slider-card]");return t&&"false"===t.getAttribute("aria-hidden")});for(const t of this.prevBtns)t.disabled=e;let t=this.cardLists.some(e=>{const t=e.querySelectorAll("[slider-card]"),s=t[t.length-1];return s&&"false"===s.getAttribute("aria-hidden")});for(const e of this.nextBtns)e.disabled=t}setSliderNavVisibility(){const e=Array.from(this.cardLists).filter(e=>e.classList.contains("is-visible")),t=0===e.length||e.some(e=>{const t=e.querySelectorAll("[slider-card]");return Array.from(t).every(e=>"false"===e.getAttribute("aria-hidden"))});for(const e of this.sliderNavs)e.hidden=t}createScrollHandler(){return e=>{const t=e.currentTarget;t.disableSliderBtnClicks=!0;for(const e of this.nextBtns)e.classList.add("is-pressed-state-blocked");for(const e of this.prevBtns)e.classList.add("is-pressed-state-blocked");clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout(()=>{t.disableSliderBtnClicks=!1;for(const e of this.nextBtns)e.classList.remove("is-pressed-state-blocked");for(const e of this.prevBtns)e.classList.remove("is-pressed-state-blocked")},100)}}getCardsPerSlide(e){let t=1;return window.innerWidth>767&&(t=e.hasAttribute("data-cards-per-slide")?parseInt(e.dataset.cardsPerSlide):1),t}createNextClickHandler(){return()=>{const e=this.cardLists.find(e=>e.classList.contains("is-visible"));if(!e)return;if(e.classList.contains("disable-scroll-snapping"))return;const t=[...e.querySelectorAll("[slider-card]")],s=t.findIndex(e=>"false"===e.getAttribute("aria-hidden")),r=t[s],i=t[s+1];t[t.length-1];if(!e.disableSliderBtnClicks&&i){this.getCardsPerSlide(e);const t=i.getBoundingClientRect().width*(s+1);e.classList.add("disable-scroll-snapping");const l=gsap.timeline({onComplete:()=>{gsap.set([r,i],{clearProps:"all",onComplete:()=>{e.scrollTo({left:t,behavior:"instant"})}}),e.classList.remove("disable-scroll-snapping")}});l.fromTo(r,{opacity:1},{opacity:0,duration:.3,ease:"emphasized-decelerate"},0),l.fromTo(i,{xPercent:0,opacity:0},{xPercent:-100,opacity:1,duration:.5,ease:"emphasized-decelerate"},.1)}}}createPrevClickHandler(){return()=>{const e=this.cardLists.find(e=>e.classList.contains("is-visible"));if(!e)return;if(e.classList.contains("disable-scroll-snapping"))return;const t=[...e.querySelectorAll("[slider-card]")],s=t.findIndex(e=>"false"===e.getAttribute("aria-hidden")),r=t[s],i=t[s-1];if(!e.disableSliderBtnClicks&&i){const t=this.getCardsPerSlide(e),l=i.getBoundingClientRect().width*(s-t);e.classList.add("disable-scroll-snapping");const n=gsap.timeline({onComplete:()=>{e.scrollTo({left:l,behavior:"instant"}),gsap.set([r,i],{clearProps:"all"}),e.classList.remove("disable-scroll-snapping")}});n.fromTo(r,{opacity:1},{opacity:0,duration:.3,ease:"emphasized-decelerate"},0),n.fromTo(i,{xPercent:0,opacity:0},{xPercent:100,opacity:1,zIndex:1,duration:.5,ease:"emphasized-decelerate"},.1)}}}scrollToCardList(e){let t;const s=e.getBoundingClientRect(),r=window.innerHeight;s.bottom>r&&(t=s.bottom-r),window.scrollBy({top:t,behavior:"smooth"})}connectedCallback(){this.setupCardObserver(),this.observeElements(this.cards),this.observeElements(this.cardLists);for(const e of this.cardLists)e.addEventListener("scroll",this.scrollHandler);for(const e of this.nextBtns)e.addEventListener("click",this.nextClickHandler);for(const e of this.prevBtns)e.addEventListener("click",this.prevClickHandler)}disconnectedCallback(){this.unobserveElements(this.cards),this.unobserveElements(this.cardLists);for(const e of this.cardLists)e.removeEventListener("scroll",this.scrollHandler);for(const e of this.nextBtns)e.removeEventListener("click",this.nextClickHandler);for(const e of this.prevBtns)e.removeEventListener("click",this.prevClickHandler)}}customElements.define("product-slider-interface",ProductSliderInterface);