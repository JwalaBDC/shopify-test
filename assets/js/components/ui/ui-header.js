class Header{constructor(e){this.element=e,this.menuButton=this.element.querySelector(".ui-header__search-btn"),this.searchCancelBtn=this.element.querySelector(".ui-header__search-cancel"),this.searchFetchButton=this.element.querySelector(".ui-header__search-searchBtn"),this.searchButton=this.element.querySelector(".ui-header__search-btn"),this.searchCloseButton=this.element.querySelector(".ui-header__search-btn--close"),this.searchDialoge=this.element.querySelector(".ui-header__search"),this.searchContainer=this.searchDialoge.querySelector(".ui-header__search-container"),this.searchForm=this.searchContainer.querySelector(".ui-header__search-form"),this.searchInput=this.searchForm.querySelector(".ui-header__search-input"),this.searchClear=this.searchForm.querySelectorAll(".ui-header__search--clear"),this.quickLinks=this.searchContainer.querySelector(".ui-header__search-quick"),this.quickLinkListItems=this.quickLinks.querySelectorAll(".ui-header__search-quick-links-btn"),this.searchInputIcon=this.element.querySelector(".ui-header__search-icon"),this.headerNav=this.element.querySelector(".ui-header__nav"),this.regionDropdown=this.element.querySelector(".ui-header__rhs .ui-header__region"),this.regionSeperator=this.element.querySelector(".ui-header__rhs-separator"),this.searchWhiteBackdrop=document.querySelector(".ui-header__search-fullwidth-bg"),this.regionSubDropdown=this.regionDropdown.querySelectorAll(".has-submenu"),this.headerHeight=this.element?this.element.offsetHeight:0,this.addListener()}toggleSearch(e){e.preventDefault();this.element.classList.contains("ui-header--search-open")?(this.element.classList.add("is-closing"),this.element.classList.add("ui-header--transparent"),this.animateSearchWhiteBackdropExit(),document.documentElement.classList.remove("is-search-menu-open"),gsap.fromTo([this.headerNav,this.regionSeperator,this.regionDropdown],{opacity:0,visibility:"hidden"},{opacity:1,visibility:"visible",duration:.2,ease:"emphasized-decelerate"})):(this.element.classList.remove("is-closing"),this.element.classList.add("ui-header--search-open"),this.element.classList.remove("ui-header--transparent"),this.searchInput.focus(),document.documentElement.classList.add("is-search-menu-open"),this.animateSearchWhiteBackdropEntry(),gsap.fromTo([this.headerNav,this.regionSeperator,this.regionDropdown],{opacity:1,visibility:"visible"},{opacity:0,visibility:"hidden",duration:.2,ease:"emphasized-decelerate"}),this.animateSearchQuickLinks())}animateSearchWhiteBackdropEntry(){this.searchContainer.style.opacity="1",gsap.fromTo(this.searchContainer,{opacity:0,height:0},{opacity:1,height:this.searchContainer.scrollHeight,duration:.2,ease:"emphasized-decelerate"}),window.disableScroll()}animateSearchWhiteBackdropExit(){this.searchContainer.style.opacity="1",gsap.to(this.searchContainer,{height:0,duration:.2,ease:"emphasized",onComplete:()=>{this.element.classList.remove("ui-header--search-open"),window.enableScroll(),this.searchClear.forEach(e=>{e.click()})}}),window.enableScroll()}animateSearchQuickLinks(){this.quickLinkItemsAnimationTl&&this.quickLinkItemsAnimationTl.kill(),gsap.timeline().fromTo(this.quickLinkListItems,{opacity:0,y:-8},{opacity:1,y:0,duration:.3,stagger:.03,ease:"standard-decelerate",overwrite:!0})}closeSearch(){this.element.classList.remove("ui-header--search-open"),this.searchClear.forEach(e=>{e.click()})}cancelSearch(){window.enableScroll(),document.documentElement.classList.remove("is-search-menu-open"),this.element.classList.remove("ui-header--search-open"),this.searchClear.forEach(e=>{e.click()}),gsap.fromTo([this.headerNav,this.regionSeperator,this.regionDropdown],{opacity:0,visibility:"hidden"},{opacity:1,visibility:"visible",duration:.2,ease:"emphasized-decelerate"})}sanitizeInput(e){return e.replace(/\s+/g," ").trim()}handleSearch(e){let t=e.currentTarget.value;t=t.replace(/\s{2,}/g," "),e.currentTarget.value=t,this.searchForm.classList.toggle("is-filled",""!==t),window.innerWidth>768&&(this.searchInputIcon.style.display=""===t?"block":"none"),this.quickLinks.style.display="block"}handleSearchSubmit(e){e&&e.preventDefault();let t=this.searchInput.value.trim();if(""===t)return;let i=decodeURIComponent(t),s=this.stripHTMLTagsRemove(i).trim();""!==s&&(this.searchInput.value=s,this.updateURIWithParams({search:s}))}updateURIWithParams(e){const t=window.location,i=new URLSearchParams(e);let s,a="";"localhost"===t.hostname?(a="/tata-chemicals/dist",s=/\/dist\/([^\/]+)/):"bdcdev.in"===t.hostname?(a="/work/tata-chemicals.com/latest",s=/\/latest\/([^\/]+)/):(a="",s=/^\/([^\/]+)/);const r=t.pathname.match(s);let h="";r&&r[1]&&["north-america","kenya","europe"].includes(r[1])&&(h=r[1]);const n=h?`/${h}`:"",o=`${t.origin}${a}${n}/global-search?${i.toString()}`;window.location.href=o}stripHTMLTagsRemove(e){const t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}handleClearSearch(e){e.preventDefault(),this.searchInput.value="",this.searchForm.classList.remove("is-filled"),this.searchDialoge.classList.remove("ui-header__search--no-result","ui-header__search--result"),this.quickLinks.style.display="block",this.searchInputIcon.style.display="block"}handleCloseOutside(e){const t=this.element.classList.contains("ui-header--search-open");!this.searchContainer.contains(e.target)&&t&&this.toggleSearch(e)}onScroll(){window.scrollY>0?this.element.classList.add("allow-transitions","has-scrolled"):this.element.classList.remove("has-scrolled"),this.element.classList[window.scrollY>this.element.offsetHeight?"add":"remove"]("ui-header--sticky"),window.innerWidth>1024&&(document.documentElement.classList.contains("is-flyout-menu-open")||this.element.classList[window.scrollY>0?"remove":"add"]("ui-header--transparent"),document.documentElement.classList.contains("is-search-menu-open")&&this.element.classList[window.scrollY>0?"add":"remove"]("ui-header--transparent"))}handleSticky(){const e=window.scrollY;void 0===this.lastScrollPosition&&(this.lastScrollPosition=e);const t=e>this.lastScrollPosition,i=e<this.lastScrollPosition;t?this.element.classList.add("ui-header--hide"):i&&this.element.classList.remove("ui-header--hide"),this.lastScrollPosition=e}debounce(e,t){let i;return function(...s){clearTimeout(i),i=setTimeout(()=>e.apply(this,s),t)}}toggleRegionDropdown(e){e.preventDefault();const t=e.currentTarget,i=t.querySelector(".ui-header__region-submenu"),s=t.closest("[dropdown-popup]"),a=t.classList.contains("is-open"),r=s.offsetHeight,h=i.scrollHeight;i.querySelectorAll(".ui-header__region-dropdown-link").forEach(e=>{e.addEventListener("click",e=>{e.stopPropagation()})}),a?gsap.to(i,{duration:.4,height:0,opacity:0,autoAlpha:0,onUpdate:()=>{s.style.height=`${r+i.offsetHeight}px`},onComplete:()=>{t.classList.remove("is-open"),s.style.height="auto"}}):(t.classList.add("is-open"),gsap.set(i,{height:0,opacity:0}),gsap.to(i,{duration:.4,height:h,opacity:1,autoAlpha:1,ease:"power2.out",onUpdate:()=>{s.style.height=`${r+i.offsetHeight}px`},onComplete:()=>{s.style.height="auto"}}))}addListener(){this.onScroll(),window.addEventListener("scroll",this.onScroll.bind(this)),this.searchContainer.addEventListener("touchstart",e=>{this.element.classList.contains("ui-header--search-open")&&this.searchInput.blur()},{passive:!0}),this.searchButton.addEventListener("click",this.toggleSearch.bind(this)),this.searchCloseButton.addEventListener("click",this.toggleSearch.bind(this)),this.searchCancelBtn.addEventListener("click",this.cancelSearch.bind(this)),this.searchInput.addEventListener("input",this.handleSearch.bind(this)),this.searchInput.addEventListener("paste",this.handleSearch.bind(this)),this.searchClear.forEach(e=>{e.addEventListener("click",this.handleClearSearch.bind(this))}),this.searchDialoge.addEventListener("click",this.handleCloseOutside.bind(this)),this.searchFetchButton.addEventListener("click",this.handleSearchSubmit.bind(this)),this.searchInput.addEventListener("keydown",e=>{"Enter"===e.key&&(e.preventDefault(),this.handleSearchSubmit(e))}),this.regionSubDropdown.forEach(e=>e.addEventListener("click",this.toggleRegionDropdown.bind(this)))}}const headerElem=document.querySelector("header");headerElem&&(window.header=new Header(headerElem));