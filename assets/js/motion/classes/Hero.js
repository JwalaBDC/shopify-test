export default class Hero{constructor({element:e}){this.container=e,this.heroImgWrapper=this.container.querySelector('[data-hero-motion-element="img-wrapper"]'),this.heroVideoWrapper=this.container.querySelector('[data-hero-motion-element="video-wrapper"]'),this.heroSplitTitle=this.container.querySelector('[data-hero-motion-element="title"]'),this.heroImg=this.container.querySelector('[data-hero-motion-element="img"]'),this.heroVideoPoster=this.container.querySelector('[data-hero-motion-element="video-poster"]'),this.heroVideo=this.container.querySelector('[data-hero-motion-element="video"]'),this.checkImgLoadStatus(),this.resizeTimer=!1,this.windowHeight=window.innerHeight,this.scrollY=window.scrollY,this.easedScale=1,this.setOffsets(),requestAnimationFrame(this.tick.bind(this)),this.addEventListeners()}checkImgLoadStatus(){this.heroVideo?this.heroVideoPoster.complete?(this.heroVideoPoster.classList.add("is-loaded"),this.animateIn()):this.heroVideoPoster.addEventListener("load",()=>{this.heroVideoPoster.classList.add("is-loaded"),this.animateIn()}):this.heroImg&&(this.heroImg.complete?this.animateIn():this.heroImg.addEventListener("load",()=>{this.animateIn()}))}animateIn(){this.heroSplitTitle?.motionInstance?.animateIn(),this.container.classList.add("animate-in")}setOffsets(){this.elementTop=this.container.getBoundingClientRect().top+window.scrollY}updateScroll(e){this.scrollY=e}onResize(){clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(()=>{this.windowHeight=window.innerHeight},100)}tick(){requestAnimationFrame(this.tick.bind(this));const e=this.elementTop-this.scrollY,t=gsap.utils.mapRange(0,-this.windowHeight,1,1.08,e),i=gsap.utils.clamp(1,1.08,t),o=gsap.utils.interpolate(this.easedScale,i,.24);this.easedScale=o,this.heroImgWrapper&&gsap.set(this.heroImgWrapper,{scale:o,transformOrigin:"top center",overwrite:!0}),this.heroVideoWrapper&&gsap.set(this.heroVideoWrapper,{scale:o,transformOrigin:"top center",overwrite:!0})}addEventListeners(){window.scrollManager.subscribe(this.updateScroll.bind(this))}}const heroMotionContainers=document.querySelectorAll("[data-motion='hero']");for(let e of heroMotionContainers)new Hero({element:e});