export default class QuickGlance{constructor({element:t}){this.container=t,this.statElements=this.container.querySelectorAll('[data-quickglance-motion-element="stat"]'),this.persist=!0,this.addEventListeners(),this.onResize(),this.setCardWidth()}init(){}addEventListeners(){window.resizeManager.subscribe(this.onResize.bind(this))}onResize(t,e){this.containerWidth=this.container.closest(".ui-quickglance-modal")?this.container.closest(".ui-quickglance-modal").offsetWidth:this.container.closest(".ui-quickglance").offsetWidth,this.incrementBy=this.containerWidth<1024?2:this.containerWidth<1280?1:2,this.lastVisibleCardIndex=this.containerWidth<1024?1:this.containerWidth<1280?2:3}setCardWidth(){this.cardWidth=this.statElements[1].offsetLeft-this.statElements[0].offsetLeft}animateIn(){if(0===this.containerWidth&&this.onResize(),this.isAnimatedIn)return;this.isAnimatedIn=!0;let t=-1;this.statElements.forEach((e,i)=>{if(i<=this.lastVisibleCardIndex&&!e.isAnimated){t+=1,e.isAnimated=!0;const i=e.querySelector('[data-quickglance-motion-element="stat-line"]'),s=e.querySelectorAll('[data-quickglance-motion-element="stat-text"]'),a=gsap.timeline({delay:.25*t});a.fromTo(s,{y:20,opacity:0},{y:0,opacity:1,transformOrigin:"bottom center",duration:.3,ease:"standard-decelerate",stagger:.075}),a.fromTo(i,{scaleY:0},{scaleY:1,transformOrigin:"bottom center",duration:.5,ease:"standard-decelerate"})}}),this.hasMoveLeftBeenCalled=!1,setInterval(()=>{if(this.hasMoveLeftBeenCalled){let t=[];this.statElements.forEach((e,i)=>{i<this.incrementBy&&(e.isAnimated=!1,t.push(e))}),t.forEach(t=>{this.container.appendChild(t)}),this.statElements=this.container.querySelectorAll('[data-quickglance-motion-element="stat"]'),gsap.set(this.statElements,{x:0})}this.hasMoveLeftBeenCalled=!0,this.lastVisibleCardIndex=window.innerWidth<1024?1:window.innerWidth<1280?2:3,this.moveLeft()},4e3)}moveLeft(){gsap.to(this.statElements,{x:-this.cardWidth*this.incrementBy,duration:.5,ease:"emphasized-decelerate"});let t=-1;this.statElements.forEach((e,i)=>{if(i<=1){e.querySelector('[data-quickglance-motion-element="stat-line"]'),e.querySelectorAll('[data-quickglance-motion-element="stat-text"]');window.innerWidth}else if(i<=this.lastVisibleCardIndex+this.incrementBy&&!e.isAnimated){e.isAnimated=!0,t+=1;const i=e.querySelector('[data-quickglance-motion-element="stat-line"]'),s=e.querySelectorAll('[data-quickglance-motion-element="stat-text"]'),a=gsap.timeline({delay:.25*t});a.to(e,{opacity:1}),a.fromTo(s,{y:20,opacity:0},{y:0,opacity:1,transformOrigin:"bottom center",duration:.3,ease:"standard-decelerate",stagger:.075}),a.fromTo(i,{opacity:0,scaleY:1},{opacity:1,scaleY:1,transformOrigin:"bottom center",duration:.1,ease:"standard-decelerate"})}})}animateOut(){this.isAnimatedIn&&this.persist?this.container.dispatchEvent(new CustomEvent("unobserve")):(this.isAnimatedIn=!1,this.statElements.forEach((t,e)=>{const i=t.querySelector('[data-quickglance-motion-element="stat-line"]'),s=t.querySelectorAll('[data-quickglance-motion-element="stat-text"]');gsap.set(i,{scaleY:0}),gsap.set(s,{opacity:0})}))}}