class ModalManager{static modalTriggers=document.querySelectorAll("[data-modal-name]");static scrollPositionBeforeOpeningModal=0;static closeModalFn=null;static init(){this.addEventListeners(),this.observeDOMChanges()}static addEventListeners(){this.modalTriggers.forEach(e=>{e.addEventListener("click",()=>this.openModal(e))})}static openModal(e){this.scrollPositionBeforeOpeningModal=window.scrollY,console.log("open",this.scrollPositionBeforeOpeningModal);const t=e.dataset.modalName,o=document.querySelector(`[data-modal="${t}"]`);o.querySelector(".ui-modal__content").addEventListener("click",e=>e.stopPropagation());const s=o.querySelector(".ui-modal__close-button"),l=this.getFocusableElements(o);s.addEventListener("click",()=>this.closeModal(o,e)),o.addEventListener("keydown",t=>this.handleKeyDown(t,o,l,e)),o.addEventListener("click",()=>this.closeModal(o,e)),o.classList.add("ui-modal--open"),document.documentElement.classList.add("is-modal-open"),this.makeOtherElementsInert(o),(o.querySelector("#modalHeading")||l.first).focus(),window.disableScroll(),this.closeModalFn=()=>this.closeModal(o,e),window.closeModal=this.closeModalFn}static closeModal(e,t){e.classList.remove("ui-modal--open"),document.documentElement.classList.remove("is-modal-open"),this.removeOtherElementsInert(),t.focus(),window.enableScroll(),window.scrollTo(0,this.scrollPositionBeforeOpeningModal),console.log("close",this.scrollPositionBeforeOpeningModal),this.closeModalFn=null,window.closeModal=null}static handleKeyDown(e,t,{first:o,last:s},l){switch(e.key){case"Escape":e.preventDefault(),this.closeModal(t,l);break;case"Tab":this.trapTabKey(e,o,s)}}static getFocusableElements(e){const t=Array.from(e.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, [tabindex="0"], [contenteditable]'));return{first:t[0],last:t[t.length-1]}}static trapTabKey(e,t,o){e.shiftKey&&document.activeElement===t?(e.preventDefault(),o.focus()):e.shiftKey||document.activeElement!==o||(e.preventDefault(),t.focus())}static makeOtherElementsInert(e){document.querySelectorAll("main").forEach(t=>{t!==e&&t.setAttribute("inert","true")})}static removeOtherElementsInert(){document.querySelectorAll("[inert]").forEach(e=>e.removeAttribute("inert"))}static observeDOMChanges(){new MutationObserver(e=>{e.forEach(e=>{"childList"===e.type&&(this.modalTriggers=document.querySelectorAll("[data-modal-name]"),this.addEventListeners())})}).observe(document.body,{childList:!0,subtree:!0})}}ModalManager.init();